### üìÑ ADR-024 : Refactorisation du Socle Technique (Clean Core)

**Date :** 09 Janvier 2026
**Statut :** Accept√©

**Contexte**
Le code actuel (v2.5) porte les stigmates du prototypage rapide :
1.  **Configuration Rigide** : La classe `Config` est statique et m√©lange des constantes m√©tier avec des configurations d'infrastructure.
2.  **Code Mort & UI Redondante** : Le `TUIManager` (interface terminal) et certaines queues multiprocessing sont devenus obsol√®tes depuis l'introduction du Dashboard Web (ADR-023), cr√©ant une double logique d'affichage co√ªteuse √† maintenir.
3.  **Typage** : L'absence de validation forte des types de donn√©es (Pydantic) fragilise les √©changes entre modules.

**D√©cision**
Nous engageons une refactorisation technique majeure ("Spring Cleaning") pour passer √† une architecture **Web-Centric** et robuste :

1.  **Adoption de Pydantic** : Remplacement de `config.py` par une classe `Settings(BaseSettings)` :
    *   Validation stricte des variables d'environnement (`.env`) au d√©marrage.
    *   Typage fort des objets m√©taux (`AudioPayload`, `NoteMetadata`) pour s√©curiser le flux de donn√©es.
2.  **Suppression du TUI (`tui_manager.py`)** : Retrait d√©finitif de `rich`, `console` et des panneaux ASCII. L'interface terminal dispara√Æt totalement.
3.  **Simplification de `main.py`** : Rationalisation des Queues. Le moteur ne "pousse" plus les logs vers l'√©cran.
    *   **Architecture "Pull"** : Le moteur √©crit son √©tat (Jauges, Logs techniques, Top 15 N≈ìuds, Derni√®res actions) dans des fichiers JSON tampons (State Files).
    *   Le Serveur Web (`fastapi`) lit ces fichiers √† la demande pour mettre √† jour l'interface.
4.  **Obsidian comme "Cold Storage"** : Le fichier `00-Dashboard.md` dans Obsidian n'est plus mis √† jour en temps r√©el (fin des clignotements). Obsidian sert uniquement de base de connaissance long terme. Les nouvelles notes atterrissent dans `Inbox`.

**Ce que l'Interface Web (FastAPI) centralise :**
*   **Console Technique** : Affichage des logs syst√®me (ex: "Connexion VAD OK").
*   **Cerveau** : Visualisation des poids, jauges d'activation.
*   **Flux** : Input/Output du LLM et transcriptions.

**Justification**
*   **Stabilit√©** : Pydantic emp√™che le d√©marrage si la config est invalide.
*   **Simplicit√©** : R√©duction de 40% du code de `main.py` en supprimant la logique d'affichage synchrone.
*   **Performance** : Le d√©couplage (√©crire un JSON vs g√©rer un affichage terminal live) lib√®re des cycles CPU pour le moteur cognitif.

**Cons√©quences**
*   Perte de l'interface visuelle si le navigateur n'est pas ouvert (accept√©).
*   N√©cessite de r√©√©crire les constructeurs principaux pour injecter `Settings`.

---

### üìÑ ADR-025 : Architecture S√©quentielle (Cerveau Unique)

**Date :** 09 Janvier 2026
**Statut :** Accept√©

**Contexte**
Le syst√®me doit g√©rer deux types de t√¢ches cognitives : l'analyse rapide (Interaction/Dashboard) et le jardinage de fond (Organisation/Merge). Les contraintes mat√©rielles emp√™chent de faire tourner deux agents LLM en parall√®le. Le traitement doit donc √™tre s√©quentiel mais prioris√©.

**D√©cision**
Nous adoptons une architecture √† **Agent Unique (Le Cerveau)** consommant une **Queue de T√¢ches √† Priorit√©**. Les r√¥les "Analyste" et "Jardinier" deviennent des *modes* d'ex√©cution du m√™me agent.

**Logique de Priorit√© (La Boucle Principale) :**

1.  **Priorit√© HAUTE (Interaction Temps R√©el)** :
    *   *D√©clencheur* : L'utilisateur parle (PTT) ou envoie un message texte.
    *   *Action* : Transcription, R√©ponse imm√©diate (Briefing Oc√©ane), Mise √† jour Web.
2.  **Priorit√© MOYENNE (Actions Explicites)** :
    *   *D√©clencheur* : Commande utilisateur sp√©cifique (ex: "Nettoie cette note", "R√©sume √ßa").
    *   *Action* : Ex√©cution cibl√©e sur un fichier.
3.  **Priorit√© BASSE (Jardinage de Fond)** :
    *   *D√©clencheur* : Syst√®me oisif (Pas d'input depuis X secondes).
    *   *Action* : D√©pilement des t√¢ches de maintenance :
        *   Scanner les notes avec le tag `#action/...`.
        *   Calculer et mettre √† jour les poids.
        *   Proposer ou ex√©cuter des fusions de concepts (Merge).

**M√©canismes de Soutien :**
*   **Poids & Attraction** : L'ajout d'un tag `#action` conf√®re un **boost de poids** artificiel (+50) √† une note. Elle devient une "irritation" que le syst√®me cherchera √† r√©soudre en priorit√© Basse.
*   **S√©curit√© du Merge (Jardinage)** :
    *   L'IA ne supprime **jamais** de contenu humain.
    *   En cas de fusion (A vers B) : Contenu de A copi√© √† la fin de B + Lien de tra√ßabilit√© + A d√©plac√© vers `99_Archives`.
*   **Zones R√©serv√©es (Zone Safety)** :
    *   L'IA ne peut modifier que le contenu situ√© entre des balises HTML invisibles (`<!-- AI_GARDEN_START -->`). Le reste est en lecture seule.

**Justification**
*   **Viabilit√© Hardware** : Un seul LLM charg√© en m√©moire.
*   **Fluidit√©** : L'utilisateur n'attend jamais que le jardinage finisse pour parler (Priorit√© Haute pr√©emptive).
*   **S√©curit√©** : Les m√©canismes d'archivage et de zones prot√®gent la donn√©e.

---

### üìÑ ADR-026 : Qualit√© du Signal et Suppression de la Taxonomie

**Date :** 09 Janvier 2026
**Statut :** Accept√©

**Contexte**
Le syst√®me souffre de pollution par le bruit oral (h√©sitations), d'une rigidit√© structurelle due √† une taxonomie fixe (Dewey), et d'une pollution du contexte LLM par les m√©tadonn√©es techniques (poids).

**D√©cision**
Nous passons d'une logique de classification a priori √† une logique de **"Filtrage Humain & Structure √âmergente"**.

1.  **Suppression de la Taxonomie Fixe** :
    *   Le `Router` n'essaie plus de classer dans des cat√©gories pr√©-d√©finies (Politique, Math...).
    *   Tout nouveau concept entre avec le tag `#√©tat/graine` dans l'`Inbox`. La structure √©mergera organiquement via les liens et le jardinage futur.
2.  **Contr√¥le du Flux (Push-to-Talk & Texte)** :
    *   Abandon du "Videur IA" (trop lent/co√ªteux). La qualit√© du signal est d√©l√©gu√©e √† l'utilisateur.
    *   **Mode Vocal (PTT)** : Le micro ne s'active que sur pression d'un bouton (Web ou Physique). Garantit le silence et l'intentionnalit√©.
    *   **Mode Texte (Chat)** : Ajout d'un champ texte dans l'interface Web pour les commandes pr√©cises, le code, ou la correction silencieuse.
3.  **Sanitisation du Prompt** :
    *   Les Poids ($W$) servent √† la **s√©lection** des notes (RAG) par le code Python.
    *   Les valeurs num√©riques sont **retir√©es** du texte envoy√© au LLM. L'IA voit le contenu, pas le score technique.

**Justification**
*   **Philosophie Zettelkasten** : "Bottom-up" plut√¥t que "Top-down". On laisse les connexions d√©finir les cat√©gories.
*   **Qualit√© des Donn√©es** : Le PTT √©limine m√©caniquement 100% des bruits de respiration, des "euh" de r√©flexion et des hallucinations de silence Whisper.
*   **Flexibilit√©** : Le mode Texte permet d'interagir avec Oc√©ane sans parler, id√©al pour le travail de bureau ou le code.

**Cons√©quences**
*   Impl√©mentation n√©cessaire d'un bouton PTT (Front Web + Backend Socket).
*   R√©√©criture de la logique d'injection RAG pour nettoyer les prompts.

---